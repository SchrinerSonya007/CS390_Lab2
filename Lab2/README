When writing the above code I used the following as reference:
https://github.com/keras-team/keras/blob/master/examples/neural_style_transfer.py
